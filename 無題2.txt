create view FieldInfo
as
select case when LEFT(c.TABLE_NAME,1) = 'A'   then '水理計算'
            when LEFT(c.TABLE_NAME,1) = 'W'   then '上水道'
            when LEFT(c.TABLE_NAME,1) = 'S'   then '下水道'
            when LEFT(c.TABLE_NAME,1) = 'R'   then '修繕'
            when LEFT(c.TABLE_NAME,1) = 'C'   then 'マスタ'
            when LEFT(c.TABLE_NAME,3) = 'NEW' then 'フリー'
       else 'その他'
       end as カテゴリ, -- TABLE_TYPEはなんか怪しいから使わない
       c.TABLE_NAME as テーブル名,
       case when c.TABLE_NAME like '%NEWTABLE%' then c.TABLE_ALIAS
            else  (select bb.LABEL -- 暫定対応
                     from C_LANG_SETTING bb,
                          C_TABLE_MASTER cc 
                    where bb.LABEL_ID = cc.LABEL_ID 
                      and bb.LANG_ID =  0 
                      and c.TABLE_NAME = cc.TABLE_NAME)
       end  as テーブル日本語名,
       a.FIELD_NAME as カラム名,
       b.LABEL  as カラム日本語名,
       case when a.FIELD_TYPE = '1' then '短整型(Short,int16)'
            when a.FIELD_TYPE = '2' then '長整型(Long,int32)'
            when a.FIELD_TYPE = '3' then '単精度少数(Float,single)'
            when a.FIELD_TYPE = '4' then '倍精度少数(Double,double)'
            when a.FIELD_TYPE = '5' then '文字列(Text,nvarchar)'
            when a.FIELD_TYPE = '6' then 'バイナリ(バイナリ,blob)' 
            when a.FIELD_TYPE = '7' then '通貨(CURRENCY,Decimal)'
       end as データ型,
       case when a.EDITABLE_FLG = '0' then '非表示'
            when a.EDITABLE_FLG = '1' then '表示'
       end as 表示非表示,
       isnull(a.NUMBER_OF_DIGITS,0) as 桁数,
       isnull(a.NUMBER_OF_DIGITS_POINT,0) as 小数,
       a.CODE_TYPE as コードマスタ参照,
       case when a.OPTION_FLG = '0' then ''
            when a.OPTION_FLG = '1' then '○'
       end as 削除不可,
       case when a.SEARCH_TYPE = 'N' then '数値型、範囲指定可能'
            when a.SEARCH_TYPE = 'T' then '文字列型、中間一致'
            when a.SEARCH_TYPE = 'C' then '文字列型、ドロップダウン'
            when a.SEARCH_TYPE = 'D' then '文字列型、範囲指定可能'
            when a.SEARCH_TYPE = 'Z' then '検索対象外'
       end as 検索方法,
       ORDER_FILTER as 検索条件表示順,
       ORDER_RESULT as 検索結果表示順,
       PROPORTIONAL_FLG as 案分フラグ,
       TAB_NO as タブ番号,
       case when a.SHAPE_OUTPUT = '0' then ''
            when a.SHAPE_OUTPUT = '1' then '○'
       end as Shape出力属性,
       case when a.ESSENTIAL_CHEAK = '0' then ''
            when a.ESSENTIAL_CHEAK = '1' then '○'
       end as 必須チェック,
       SORT_ORDER as 並び順
  from C_FIELD_MASTER a left outer join C_LANG_SETTING b on a.LABEL_ID = b.LABEL_ID and b.LANG_ID =  0 -- 一応外部結合
                        left outer join C_TABLE_MASTER c on a.TABLE_NUM = c.TABLE_NUM                  -- 一応外部結合
order by a.TABLE_NUM,
         a.FIELD_NUM
OFFSET 0 ROWS
